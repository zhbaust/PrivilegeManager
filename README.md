# PrivilegeManager
看到一片很好的博文，是权限管理的，正好需要用到，就学习了一下，以下是学习的内容已经自己验证的结果。



我们要设计的权限管理系统，要使用Filter实现URL级别的权限认证。那我们不禁就要想设计出的权限管理系统应该使用在哪种情景中呢？我想应该是这样的一种情景吧：在实际开发中我们经常把一些执行敏感操作的servlet映射到一些特殊目录中，并用filter把这些特殊目录保护起来，限制只能拥有相应访问权限的用户才能访问这些目录下的资源。从而在我们系统中实现一种URL级别的权限功能。而且为使Filter具有通用性，Filter保护的资源和相应的访问权限通过filter参数的形式予以配置。

创建MVC架构的Web项目

在Eclipse中新创建一个day20的项目，导入项目所需要的开发包(jar包)，创建项目所需要的包，在Java Web开发中，架构的层次是以包的形式体现出来的。 
项目所需要的开发包(jar包)：

序号	开发包名称	描述
①	stl-1.2.jar	jstl标签库和EL表达式依赖包
②	mysql-connector-java-5.1.38-bin.jar	MySQL数据库驱动包
③	commons-beanutils-1.9.2.jar	工具类，用于处理bean对象
④	commons-logging-1.2.jar	commons-beanutils-1.9.2.jar的依赖jar包
⑤	commons-collections-3.2.2.jar	commons-beanutils-1.9.2.jar的依赖jar包
⑥	c3p0-0.9.5.2.jar	Java配置C3P0数据库连接池使用的包
⑦	mchange-commons-java-0.2.11.jar	C3P0依赖的相关jar包
⑧	commons-dbutils-1.6.jar	Apache组织提供的一个开源JDBC工具类库
项目所需要的包：

序号	包名	描述	所属层次
①	cn.itcast.domain	存放系统的JavaBean类(只包含简单的属性以及属性对应的get和set方法，不包含具体的业务处理方法)，提供给【数据访问层】、【业务逻辑层】、【Web层】来使用	domain(域模型)层
②	cn.itcast.dao	在此工程中只存放访问数据库的操作接口的实现类	数据访问层
③	cn.itcast.service	在此工程中只存放处理系统业务接口的实现类	业务逻辑层
④	cn.itcast.web.controller	存放作为系统控制器的Servlet(处理请求的servlet)	Web层(表现层)
⑤	cn.itcast.web.filter	存放作为系统过滤器的Filter	Web层(表现层)
⑥	cn.itcast.utils	存放系统的通用工具类，提供给【数据访问层】、【业务逻辑层】、【Web层】来使用	
以上就是根据此项目的实际情况创建的包，可能还需要创建其他的包，这个得根据项目的需要来定了。

权限管理系统的设计和分析

我们若要设计一个这样的权限管理系统，肯定就要考虑需要设计几个对象，一般来说大概至少需要以下四个对象：

Resource：代表系统中的每一个资源(超链接)。
Privilege：代表访问资源的权限。
Role：资源属于什么角色(管理员、经理、普通员工)。
User：用户。
现在我们来思考这几个对象之间的关系，万事万物总该有那么一点联系吧！

权限和资源之间的关系： 
若一个资源需要一个权限，这是一对一的关系；若一个权限可以控制多个资源，并且一个资源只能对应有一个控制权限，这是一对多的关系。但是在此权限管理系统中我们选择后者，即一对多的关系。
权限和角色之间的关系： 
一个角色有多个权限，一个权限赋予多个角色，这是多对多的关系。
用户和角色之间的关系： 
一个用户有可能拥有多个角色(多重身份)，一个角色可能被赋予多个用户，这是多对多的关系。
明了上述内容之后，我们就来设计这四个对象，即开发domain层。

开发domain层

首先我们来分析和设计权限(Privilege)这个类，该类一些基本的属性，我们忽略，而来着重分析权限和资源以及权限和角色之间的关系。

在分析和设计权限(Privilege)这个类时，这个类可以不设置集合来记住它控制的哪些资源，由于在页面里面一般是没有这个需求的，我们在显示这个权限的时候，我们不需要说这个权限控制了哪几个资源，我们只会说在显示资源的时候，说它被哪个权限控制。
在分析和设计权限(Privilege)这个类时，我有必要设计一个集合来记住这个权限授予了哪些角色吗？——没有必要，一般来说，只是在显示角色的时候，我们才会说这个角色拥有哪些权限，我们是不会在页面里说在显示权限的时候，权限授予了哪些角色。
分析完了，权限(Privilege)这个类的代码实现就会一目了然，我们在cn.itcast.domain包中创建这个权限(Privilege)类。 
Filter(过滤器)常见应用(三)——权限管理系统(一):地址如下：

http://blog.csdn.net/yerenyuan_pku/article/details/52514114



Filter(过滤器)常见应用(三)——权限管理系统(二) 地址如下

http://blog.csdn.net/yerenyuan_pku/article/details/52517160

Filter(过滤器)常见应用(三)——权限管理系统(三)地址如下：

http://blog.csdn.net/yerenyuan_pku/article/details/52525654

学习后，自己把其代码进行了实现，效果如下：

1、登录页面：登录页面的布局是从网上找的一个布局，下载网址：

http://www.ui.cn/detail/70262.html，第14个。修改后，如图1所示。


图1 登录界面
2、主界面，如图2所示。主界面使用的代码在这里下载的：http://kit.zhengjinfan.cn/，里面还有不少错误，引用时还没完全搞懂，将就能用。

图2 主界面
3、用户角色创建：里面的界面还是用博主的界面，还没来得及修改，如图3所示。

图3 角色管理

权限控制能够在该主界面的左侧导航栏上使用，如图4所示。

并且可以控制用户看到的菜单。界面还有待改善，以后有时间将进行修改。
